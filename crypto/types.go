package crypto

import "errors"

// KeyMap — тип-алиас для карты, хранящей криптографические ключи.
//
// Структура:
//   - Ключ: строковое имя типа данных (например, "USER_EMAIL", "API_KEY")
//   - Значение: []byte — 32-байтный (256-битный) криптографический ключ
//
// Требования:
//   - Каждый ключ ДОЛЖЕН быть ровно 32 байта длиной
//   - Это требование проверяется в NewCryptoService()
//   - Ключи должны быть секретными и храниться вне кода (в .env, Vault, KMS и т.д.)
//
// Пример использования:
//   keys := KeyMap{
//       "USER_EMAIL": []byte("32-byte-secret-key-here........"),
//       "API_KEY":    generateSecureKey(),
//   }
type KeyMap map[string][]byte

// Стандартные ошибки модуля.
// Все ошибки объявлены как переменные, чтобы их можно было
// сравнивать с помощью errors.Is(err, crypto.ErrUnknownDataType).
// Это лучшая практика в Go для обработки ошибок.

// ErrUnknownDataType возвращается, когда запрашиваемый тип данных
// не поддерживается модулем (например, при вызове Encrypt("...", "UNKNOWN_TYPE")).
// Это помогает выявлять опечатки в конфигурации или коде.
var ErrUnknownDataType = errors.New("unknown data type")

// ErrInvalidKeySize возвращается, когда предоставленный ключ
// не имеет длину 32 байта (256 бит).
// AES-256 и безопасные HMAC-функции требуют именно такой длины ключа.
// Эта ошибка возникает только в NewCryptoService().
var ErrInvalidKeySize = errors.New("key must be exactly 32 bytes")

// ErrMissingField возвращается, когда в структуре данных отсутствуют
// обязательные поля (например, при расшифровке GCM без authTag).
// Хотя в текущей реализации эта ошибка не используется напрямую,
// она зарезервирована для будущего расширения API
// (например, если ты добавишь метод, принимающий структуру с полями).
var ErrMissingField = errors.New("missing required field")

// ErrDecryption возвращается, когда операция расшифровки завершилась неудачно.
// Причины могут быть разными:
//   - Неверный ключ
//   - Повреждённые данные
//   - Несовпадение authTag (в GCM)
//   - Неверный padding (в CBC)
// Важно: эта ошибка НЕ раскрывает детали (чтобы избежать атак по времени или padding oracle),
// поэтому возвращается общее сообщение.
var ErrDecryption = errors.New("decryption failed")
